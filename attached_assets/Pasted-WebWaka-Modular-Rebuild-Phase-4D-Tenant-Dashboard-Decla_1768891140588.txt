WebWaka Modular Rebuild â€” Phase 4D: Tenant Dashboard (Declarative Consumer)

â¸»

CONTEXT

You are operating as an implementation platform (Replit) on behalf of the WebWaka Modular Rebuild.

This task implements Phase 4D, which is the Tenant Dashboard, following and consuming the already-completed:
	â€¢	Phase 4A â€” Core Dashboard Control Model
	â€¢	Phase 4B â€” Super Admin Dashboard (Declarative)
	â€¢	Phase 4C â€” Partner Dashboard (Declarative)

This phase is constitutionally locked and must not deviate.

â¸»

HARD CONSTRAINTS (NON-NEGOTIABLE)

ğŸš« DO NOT invent access logic
ğŸš« DO NOT hardcode roles
ğŸš« DO NOT bypass Phase 4A engine
ğŸš« DO NOT implement business logic
ğŸš« DO NOT implement backend services
ğŸš« DO NOT implement UI styling or frontend frameworks

âœ… This is a pure declarative dashboard consumer

â¸»

SOURCE OF TRUTH
	â€¢	Constitution: WebWaka Ecosystem Constitution v1.4 (Ratified)
	â€¢	Core Engine: webwaka-core-dashboard-control
	â€¢	Evaluation primitives:
	â€¢	Permissions
	â€¢	Entitlements
	â€¢	Feature Flags
	â€¢	Resolution engine: Phase 4A ONLY

â¸»

TARGET REPOSITORY

Repository: webwaka-suite-tenant-dashboard
(This repo already exists and is configured. Do NOT create a new repo.)

â¸»

OBJECTIVE

Implement the Tenant Dashboard as a pure declarative dashboard definition that:
	â€¢	Defines tenant-visible sections
	â€¢	Uses permissions, entitlements, and feature flags only for gating
	â€¢	Resolves visibility exclusively through Phase 4A
	â€¢	Supports offline snapshot evaluation
	â€¢	Is fully deterministic and explainable

â¸»

REQUIRED DELIVERABLES

1ï¸âƒ£ Dashboard Declaration (Pure Data)

Create pure, serializable declarations only:

src/dashboards/tenant.dashboard.ts
src/dashboards/tenant.sections.ts

Rules:
	â€¢	No functions inside declarations
	â€¢	JSON-serializable
	â€¢	Deterministic ordering
	â€¢	No environment access

â¸»

2ï¸âƒ£ REQUIRED TENANT DASHBOARD SECTIONS

Implement exactly the following sections and gating:

#	Section	Permissions	Entitlements	Feature Flags
1	Tenant Overview	tenant:overview:read	â€”	â€”
2	Users & Roles	users:read	user-management	â€”
3	Products / Services	catalog:read	â€”	â€”
4	Sales / POS	pos:read	pos-access	pos-enabled
5	Inventory	inventory:read	inventory-access	inventory-enabled
6	Billing & Subscriptions	billing:read	billing-access	â€”
7	Receipts & Transactions	receipts:read	â€”	â€”
8	Incentives & Rewards	incentives:read	incentives-access	incentives-enabled
9	Branding (Tenant-level)	branding:read	tenant-branding	whitelabel-enabled
10	Audit & Activity	audit:read	audit-access	â€”
11	AI / Automation	ai:read	ai-access	ai-features-enabled
12	Settings	tenant:settings:read	â€”	â€”

âš ï¸ Do NOT add or remove sections
âš ï¸ Do NOT relax gating rules

â¸»

3ï¸âƒ£ Dashboard Resolution Engine (Consumer Only)

Create a thin consumer layer that calls Phase 4A:

src/engine/tenantDashboardResolver.ts

Must use:
	â€¢	resolveDashboard(declaration, context)
	â€¢	generateDashboardSnapshot(resolved, expirationHours?)
	â€¢	verifyDashboardSnapshot(snapshot)
	â€¢	evaluateFromSnapshot(snapshot)

ğŸš« No custom evaluation logic allowed.

â¸»

4ï¸âƒ£ Snapshot Support (MANDATORY)

You must implement and test:
	â€¢	Snapshot generation
	â€¢	Snapshot verification
	â€¢	Snapshot expiration
	â€¢	Offline evaluation parity

â¸»

5ï¸âƒ£ Tests (MANDATORY)

Create a comprehensive test suite proving:

Visibility Gating
	â€¢	Permission missing â†’ section hidden
	â€¢	Entitlement missing â†’ section hidden
	â€¢	Feature flag disabled â†’ section hidden

Determinism
	â€¢	Same input â†’ same output (10Ã— repeat test)

Snapshot Integrity
	â€¢	Valid snapshot verifies
	â€¢	Tampered snapshot fails
	â€¢	Expired snapshot fails

Tenant Isolation
	â€¢	Cross-tenant access throws error

â¸»

6ï¸âƒ£ Registered Capabilities

Register the following capabilities in module.manifest.json:

[
  "dashboard:tenant.resolve",
  "dashboard:tenant.snapshot.generate",
  "dashboard:tenant.snapshot.verify"
]


â¸»

HARD STOP CONDITION (MUST BE PROVEN)

A Tenant Suite can request its dashboard online or offline and receive a deterministic, explainable, verifiable result where every visible or hidden section is justified exclusively by permissions, entitlements, and feature flags.

You must include a hard-stop test explicitly proving this.

â¸»

REQUIRED FINAL OUTPUT

When complete, provide a Phase 4D Completion Report containing:
	1.	Section list + gating matrix
	2.	Proof of Phase 4A engine consumption
	3.	Snapshot verification evidence
	4.	Test results summary
	5.	Final commit SHA

â¸»

STOP CLAUSE

â›” STOP immediately after completion
â›” Do NOT proceed to any further phase
â›” Await explicit authorization

â¸»

ACKNOWLEDGEMENT FORMAT

Reply only with:

â€œAcknowledged. Proceeding with Phase 4D execution exactly as instructed.â€

Then begin.